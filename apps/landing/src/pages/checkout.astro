---
import Layout from '../layouts/Layout.astro';
---

<Layout 
    title="Checkout - Apuntes Premium para Programadores"
    description="Completa tu compra y obt√©n acceso inmediato a m√°s de 100 apuntes profesionales de programaci√≥n."
>
    <main class="min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50 py-8 sm:py-16 px-4">
        <div class="max-w-5xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-8 sm:mb-12">
                <a href="/" class="inline-flex items-center gap-2 text-slate-600 hover:text-primary mb-6 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                    Volver
                </a>
                <h1 class="text-3xl sm:text-4xl md:text-5xl font-black text-primary mb-3">¬°Est√°s a un paso! üöÄ</h1>
                <p class="text-lg sm:text-xl text-slate-600">Completa tu compra y empieza a aprender m√°s r√°pido</p>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Columna izquierda: Resumen del pedido -->
                <div class="lg:order-2">
                    <div class="bg-white rounded-3xl p-6 sm:p-8 shadow-2xl border-2 border-slate-100 sticky top-8">
                        <h2 class="text-2xl font-black text-primary mb-6">Resumen del pedido</h2>
                        
                        <!-- Producto -->
                        <div class="flex items-start gap-4 mb-6 pb-6 border-b border-slate-200">
                            <div class="w-16 h-16 bg-gradient-to-br from-primary to-secondary rounded-2xl flex items-center justify-center flex-shrink-0 shadow-lg">
                                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <h3 class="font-black text-lg text-primary mb-1">Apuntes Premium</h3>
                                <p class="text-sm text-slate-600">Acceso completo de por vida</p>
                            </div>
                        </div>

                        <!-- Lo que incluye -->
                        <div class="mb-6 pb-6 border-b border-slate-200">
                            <h3 class="font-bold text-primary mb-4 text-sm uppercase tracking-wide">Incluye:</h3>
                            <ul class="space-y-3 text-sm">
                                {[
                                    "100+ apuntes profesionales",
                                    "Todas las categor√≠as (Frontend, Backend, DevOps...)",
                                    "Actualizaciones semanales gratis",
                                    "Acceso desde cualquier dispositivo",
                                    "Soporte prioritario",
                                    "Sin suscripciones, pago √∫nico"
                                ].map((item) => (
                                    <li class="flex items-start gap-2">
                                        <svg class="w-5 h-5 text-green-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                                        <span class="text-slate-700">{item}</span>
                                    </li>
                                ))}
                            </ul>
                        </div>

                        <!-- Precio -->
                        <div class="mb-6">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-slate-600">Precio original</span>
                                <span class="text-slate-400 line-through text-lg font-bold">49,99‚Ç¨</span>
                            </div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-green-600 font-bold">Descuento de lanzamiento</span>
                                <span class="text-green-600 font-bold">-40,00‚Ç¨</span>
                            </div>
                            <div class="flex items-center justify-between pt-4 border-t-2 border-slate-200">
                                <span class="text-xl font-black text-primary">Total</span>
                                <span class="text-4xl font-black bg-gradient-to-r from-secondary to-blue-600 bg-clip-text text-transparent">9,99‚Ç¨</span>
                            </div>
                        </div>

                        <!-- Garant√≠as -->
                        <div class="bg-green-50 rounded-2xl p-4 border-2 border-green-200">
                            <div class="flex items-start gap-3">
                                <svg class="w-6 h-6 text-green-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
                                <div>
                                    <p class="font-bold text-green-900 text-sm mb-1">Compra 100% segura</p>
                                    <p class="text-xs text-green-700">Pago procesado por Stripe. Garant√≠a de satisfacci√≥n total.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Columna derecha: Formulario/Acci√≥n -->
                <div class="lg:order-1">
                    <div class="bg-white rounded-3xl p-6 sm:p-8 shadow-2xl border-2 border-slate-100">
                        <h2 class="text-2xl font-black text-primary mb-2">Completa tu informaci√≥n</h2>
                        <p class="text-slate-600 mb-8">Te enviaremos el acceso a este email</p>

                        <!-- Formulario -->
                        <form id="checkout-form" class="space-y-6">
                            <!-- Email -->
                            <div>
                                <label for="email" class="block text-sm font-bold text-primary mb-2">
                                    Email *
                                </label>
                                <input 
                                    type="email" 
                                    id="email" 
                                    name="email" 
                                    required
                                    class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-secondary focus:outline-none focus:ring-2 focus:ring-secondary/20 transition-all text-slate-900"
                                    placeholder="tu@email.com"
                                />
                                <p id="email-error" class="hidden text-red-600 text-sm mt-1">Por favor ingresa un email v√°lido</p>
                            </div>

                            <!-- Nombre -->
                            <div>
                                <label for="name" class="block text-sm font-bold text-primary mb-2">
                                    Nombre completo *
                                </label>
                                <input 
                                    type="text" 
                                    id="name" 
                                    name="name" 
                                    required
                                    class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-secondary focus:outline-none focus:ring-2 focus:ring-secondary/20 transition-all text-slate-900"
                                    placeholder="Juan P√©rez"
                                />
                                <p id="name-error" class="hidden text-red-600 text-sm mt-1">Por favor ingresa tu nombre</p>
                            </div>

                            <!-- Pa√≠s (opcional para contexto) -->
                            <div>
                                <label for="country" class="block text-sm font-bold text-primary mb-2">
                                    Pa√≠s
                                </label>
                                <select 
                                    id="country" 
                                    name="country"
                                    class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-secondary focus:outline-none focus:ring-2 focus:ring-secondary/20 transition-all text-slate-900"
                                >
                                    <option value="">Selecciona tu pa√≠s</option>
                                    <option value="ES">Espa√±a</option>
                                    <option value="MX">M√©xico</option>
                                    <option value="AR">Argentina</option>
                                    <option value="CO">Colombia</option>
                                    <option value="CL">Chile</option>
                                    <option value="PE">Per√∫</option>
                                    <option value="VE">Venezuela</option>
                                    <option value="EC">Ecuador</option>
                                    <option value="GT">Guatemala</option>
                                    <option value="CU">Cuba</option>
                                    <option value="BO">Bolivia</option>
                                    <option value="DO">Rep√∫blica Dominicana</option>
                                    <option value="HN">Honduras</option>
                                    <option value="PY">Paraguay</option>
                                    <option value="SV">El Salvador</option>
                                    <option value="NI">Nicaragua</option>
                                    <option value="CR">Costa Rica</option>
                                    <option value="PA">Panam√°</option>
                                    <option value="UY">Uruguay</option>
                                    <option value="US">Estados Unidos</option>
                                    <option value="OTHER">Otro</option>
                                </select>
                            </div>

                            <!-- M√©todos de pago disponibles -->
                            <div class="bg-slate-50 rounded-xl p-5 border border-slate-200">
                                <p class="text-sm font-bold text-primary mb-3">M√©todos de pago disponibles:</p>
                                <div class="grid grid-cols-3 gap-3">
                                    <!-- Tarjetas -->
                                    <div class="bg-white rounded-lg p-3 border border-slate-200 flex flex-col items-center justify-center gap-2">
                                        <div class="flex items-center gap-1">
                                            <svg class="w-8 h-5" viewBox="0 0 48 32" fill="none"><rect width="48" height="32" rx="4" fill="#1434CB"/><path d="M18.5 16L14 11.5L9.5 16L14 20.5L18.5 16Z" fill="#FF0000"/><path d="M29.5 16L25 11.5L20.5 16L25 20.5L29.5 16Z" fill="#FFA500" fill-opacity="0.7"/></svg>
                                            <svg class="w-8 h-5" viewBox="0 0 48 32" fill="none"><rect width="48" height="32" rx="4" fill="#0066B2"/><ellipse cx="16" cy="16" rx="8" ry="8" fill="#CC0000"/><ellipse cx="24" cy="16" rx="8" ry="8" fill="#FF9900" fill-opacity="0.6"/></svg>
                                        </div>
                                        <span class="text-xs font-medium text-slate-700">Tarjeta</span>
                                    </div>
                                    
                                    <!-- PayPal -->
                                    <div class="bg-white rounded-lg p-3 border border-slate-200 flex flex-col items-center justify-center gap-2">
                                        <svg class="w-12 h-5" viewBox="0 0 124 33" fill="none">
                                            <path d="M46.211 6.749h-6.839a.95.95 0 0 0-.939.802l-2.766 17.537a.57.57 0 0 0 .564.658h3.265a.95.95 0 0 0 .939-.803l.746-4.73a.95.95 0 0 1 .938-.803h2.165c4.505 0 7.105-2.18 7.784-6.5.306-1.89.013-3.375-.872-4.415-.972-1.142-2.696-1.746-4.985-1.746zM47 13.154c-.374 2.454-2.249 2.454-4.062 2.454h-1.032l.724-4.583a.57.57 0 0 1 .563-.481h.473c1.235 0 2.4 0 3.002.704.359.42.468 1.044.332 1.906zM66.654 13.075h-3.275a.57.57 0 0 0-.563.481l-.145.916-.229-.332c-.709-1.029-2.29-1.373-3.868-1.373-3.619 0-6.71 2.741-7.312 6.586-.313 1.918.132 3.752 1.22 5.031.998 1.176 2.426 1.666 4.125 1.666 2.916 0 4.533-1.875 4.533-1.875l-.146.91a.57.57 0 0 0 .562.66h2.95a.95.95 0 0 0 .939-.803l1.77-11.209a.568.568 0 0 0-.561-.658zm-4.565 6.374c-.316 1.871-1.801 3.127-3.695 3.127-.951 0-1.711-.305-2.199-.883-.484-.574-.668-1.391-.514-2.301.295-1.855 1.805-3.152 3.67-3.152.93 0 1.686.309 2.184.892.499.589.697 1.411.554 2.317zM84.096 13.075h-3.291a.954.954 0 0 0-.787.417l-4.539 6.686-1.924-6.425a.953.953 0 0 0-.912-.678h-3.234a.57.57 0 0 0-.541.754l3.625 10.638-3.408 4.811a.57.57 0 0 0 .465.9h3.287a.949.949 0 0 0 .781-.408l10.946-15.8a.57.57 0 0 0-.468-.895z" fill="#253B80"/>
                                            <path d="M94.992 6.749h-6.84a.95.95 0 0 0-.938.802l-2.766 17.537a.569.569 0 0 0 .562.658h3.51a.665.665 0 0 0 .656-.562l.785-4.971a.95.95 0 0 1 .938-.803h2.164c4.506 0 7.105-2.18 7.785-6.5.307-1.89.012-3.375-.873-4.415-.971-1.142-2.694-1.746-4.983-1.746zm.789 6.405c-.373 2.454-2.248 2.454-4.062 2.454h-1.031l.725-4.583a.568.568 0 0 1 .562-.481h.473c1.234 0 2.4 0 3.002.704.359.42.468 1.044.331 1.906zM115.434 13.075h-3.273a.567.567 0 0 0-.562.481l-.145.916-.23-.332c-.709-1.029-2.289-1.373-3.867-1.373-3.619 0-6.709 2.741-7.311 6.586-.312 1.918.131 3.752 1.219 5.031 1 1.176 2.426 1.666 4.125 1.666 2.916 0 4.533-1.875 4.533-1.875l-.146.91a.57.57 0 0 0 .564.66h2.949a.95.95 0 0 0 .938-.803l1.771-11.209a.571.571 0 0 0-.565-.658zm-4.565 6.374c-.314 1.871-1.801 3.127-3.695 3.127-.949 0-1.711-.305-2.199-.883-.484-.574-.666-1.391-.514-2.301.297-1.855 1.805-3.152 3.67-3.152.93 0 1.686.309 2.184.892.501.589.699 1.411.554 2.317zM119.295 7.23l-2.807 17.858a.569.569 0 0 0 .562.658h2.822c.469 0 .867-.34.939-.803l2.768-17.536a.57.57 0 0 0-.562-.659h-3.16a.571.571 0 0 0-.562.482z" fill="#179BD7"/>
                                            <path d="M7.266 29.154l.523-3.322-1.165-.027H1.061L4.927 1.292a.316.316 0 0 1 .314-.268h9.38c3.114 0 5.263.648 6.385 1.927.526.6.861 1.227 1.023 1.917.17.724.173 1.589.007 2.644l-.012.077v.676l.526.298a3.69 3.69 0 0 1 1.065.812c.45.513.741 1.165.864 1.938.127.795.085 1.741-.123 2.812-.24 1.232-.628 2.305-1.152 3.183a6.547 6.547 0 0 1-1.825 2c-.696.494-1.523.869-2.458 1.109-.906.236-1.939.355-3.072.355h-.73c-.522 0-1.029.188-1.427.525a2.21 2.21 0 0 0-.744 1.328l-.055.299-.924 5.855-.042.215c-.011.068-.03.102-.058.125a.155.155 0 0 1-.096.035H7.266z" fill="#253B80"/>
                                            <path d="M23.048 7.667c-.028.179-.06.362-.096.55-1.237 6.351-5.469 8.545-10.874 8.545H9.326c-.661 0-1.218.48-1.321 1.132L6.596 26.83l-.399 2.533a.704.704 0 0 0 .695.814h4.881c.578 0 1.069-.42 1.16-.99l.048-.248.919-5.832.059-.32c.09-.572.582-.992 1.16-.992h.73c4.729 0 8.431-1.92 9.513-7.476.452-2.321.218-4.259-.978-5.622a4.667 4.667 0 0 0-1.336-1.03z" fill="#179BD7"/>
                                            <path d="M21.754 7.151a9.757 9.757 0 0 0-1.203-.267 15.284 15.284 0 0 0-2.426-.177h-7.352a1.172 1.172 0 0 0-1.159.992L8.05 17.605l-.045.289a1.336 1.336 0 0 1 1.321-1.132h2.752c5.405 0 9.637-2.195 10.874-8.545.037-.188.068-.371.096-.55a6.594 6.594 0 0 0-1.017-.429 9.045 9.045 0 0 0-.277-.087z" fill="#222D65"/>
                                            <path d="M9.614 7.699a1.169 1.169 0 0 1 1.159-.991h7.352c.871 0 1.684.057 2.426.177a9.757 9.757 0 0 1 1.481.353c.365.121.704.264 1.017.429.368-2.347-.003-3.945-1.272-5.392C20.378.682 17.853 0 14.622 0h-9.38c-.66 0-1.223.48-1.325 1.133L.01 25.898a.806.806 0 0 0 .795.932h5.791l1.454-9.225 1.564-9.906z" fill="#253B80"/>
                                        </svg>
                                        <span class="text-xs font-medium text-slate-700">PayPal</span>
                                    </div>
                                    
                                    <!-- Google Pay -->
                                    <div class="bg-white rounded-lg p-3 border border-slate-200 flex flex-col items-center justify-center gap-2">
                                        <svg class="w-12 h-5" viewBox="0 0 61 25" fill="none">
                                            <path d="M29.2 12.5v7.33h-2.35V2.17h6.22c1.5 0 2.94.58 4 1.62 1.1 1.05 1.72 2.47 1.72 3.96 0 1.5-.62 2.93-1.71 3.98a5.61 5.61 0 0 1-4.01 1.65h-3.87v.02zm0-8.18v5.95h3.9c.88 0 1.73-.35 2.35-.98.63-.62.98-1.47.98-2.35 0-.88-.35-1.72-.98-2.35a3.32 3.32 0 0 0-2.35-.97h-3.9v-.3zM42.7 8.38c1.97 0 3.52.54 4.65 1.62 1.13 1.08 1.7 2.58 1.7 4.5v5.33h-2.21v-1.2h-.1c-.98 1.12-2.23 1.68-3.75 1.68-1.37 0-2.52-.4-3.45-1.2a3.9 3.9 0 0 1-1.4-3.07c0-1.3.48-2.33 1.45-3.08.97-.75 2.27-1.13 3.9-1.13 1.37 0 2.5.24 3.39.72v-.5c0-.8-.34-1.57-.94-2.14a3.23 3.23 0 0 0-2.24-.88c-1.3 0-2.33.55-3.08 1.65l-2.03-1.28c1.13-1.62 2.87-2.43 5.21-2.43l-.1.01zm-3.17 8.63c0 .62.27 1.21.75 1.64.48.43 1.09.66 1.73.65 1.03 0 2.03-.45 2.76-1.24.8-.87 1.2-1.87 1.2-3 -.75-.6-1.77-.9-3.06-.9-1 0-1.85.26-2.54.78-.69.52-1.04 1.15-1.04 1.89v.18h.2zM61 8.85l-7.5 17.32h-2.42l2.8-6.08-4.93-11.24h2.54l3.6 8.53h.05l3.48-8.53H61z" fill="#5F6368"/>
                                            <path d="M21.38 10.74c0-.71-.06-1.43-.18-2.13H10.94v4.03h5.86a5.01 5.01 0 0 1-2.17 3.28v2.62h3.51c2.06-1.89 3.24-4.68 3.24-7.8z" fill="#4285F4"/>
                                            <path d="M10.94 21.54c2.94 0 5.4-.97 7.2-2.62l-3.51-2.73c-.97.65-2.22 1.03-3.69 1.03-2.84 0-5.24-1.91-6.1-4.48H1.23v2.81a10.94 10.94 0 0 0 9.71 5.99z" fill="#34A853"/>
                                            <path d="M4.84 12.74a6.57 6.57 0 0 1 0-4.2V5.73H1.23a10.94 10.94 0 0 0 0 9.82l3.61-2.81z" fill="#FBBC04"/>
                                            <path d="M10.94 4.06c1.6-.02 3.14.56 4.29 1.62l3.21-3.21C16.5.89 13.8-.08 10.94 0A10.94 10.94 0 0 0 1.23 5.73l3.61 2.81c.86-2.57 3.26-4.48 6.1-4.48z" fill="#EA4335"/>
                                        </svg>
                                        <span class="text-xs font-medium text-slate-700">Google Pay</span>
                                    </div>
                                </div>
                                <p class="text-xs text-slate-500 mt-3 text-center">Procesamiento seguro por Stripe ‚Ä¢ Cifrado SSL</p>
                            </div>

                            <!-- Checkbox de t√©rminos -->
                            <div class="flex items-start gap-3">
                                <input 
                                    type="checkbox" 
                                    id="terms" 
                                    name="terms" 
                                    required
                                    class="mt-1 w-5 h-5 border-2 border-slate-300 rounded focus:ring-2 focus:ring-secondary/20 text-secondary"
                                />
                                <label for="terms" class="text-sm text-slate-600">
                                    Acepto los <a href="/terminos" class="text-secondary underline hover:text-blue-600">t√©rminos y condiciones</a> y la <a href="/privacidad" class="text-secondary underline hover:text-blue-600">pol√≠tica de privacidad</a>
                                </label>
                            </div>
                            <p id="terms-error" class="hidden text-red-600 text-sm">Debes aceptar los t√©rminos para continuar</p>

                            <!-- Bot√≥n de pago -->
                            <button 
                                type="submit"
                                id="checkout-btn" 
                                class="w-full py-5 bg-gradient-to-r from-secondary to-blue-600 text-white text-xl font-black rounded-2xl shadow-2xl active:scale-95 transition-all touch-manipulation flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
                                <span id="btn-text">Continuar al pago seguro</span>
                            </button>
                            <p class="text-center text-xs text-slate-500 -mt-2">Ser√°s redirigido a Stripe para completar el pago</p>
                            <p id="checkout-error" class="hidden text-center text-sm text-red-600 font-medium"></p>
    </div>
                        </form>

                        <!-- Qu√© pasa despu√©s -->
                        <div class="bg-blue-50 rounded-2xl p-6 border border-blue-200 mt-8">
                            <h3 class="font-black text-primary mb-4 flex items-center gap-2">
                                <span class="text-2xl">üìß</span>
                                ¬øQu√© pasa despu√©s del pago?
                            </h3>
                            <ol class="space-y-3 text-sm text-slate-700">
                                <li class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-6 h-6 bg-secondary text-white rounded-full flex items-center justify-center text-xs font-bold">1</span>
                                    <span>Recibes un email con tu enlace de acceso</span>
                                </li>
                                <li class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-6 h-6 bg-secondary text-white rounded-full flex items-center justify-center text-xs font-bold">2</span>
                                    <span>Haces clic y accedes directamente (sin contrase√±as)</span>
                                </li>
                                <li class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-6 h-6 bg-secondary text-white rounded-full flex items-center justify-center text-xs font-bold">3</span>
                                    <span>Empiezas a aprender de inmediato</span>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Social proof -->
            <div class="mt-12 text-center">
                <p class="text-sm text-slate-500 mb-4">√önete a m√°s de 1,240 programadores que ya est√°n aprendiendo</p>
                <div class="flex justify-center items-center gap-1">
                    {Array(5).fill(0).map(() => (
                        <svg class="w-6 h-6 text-yellow-400" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>
                    ))}
                    <span class="ml-2 text-slate-600 font-semibold">4.9/5</span>
                </div>
            </div>
        </div>
    </main>
</Layout>

<script>
    const form = document.getElementById('checkout-form') as HTMLFormElement;
    const checkoutBtn = document.getElementById('checkout-btn') as HTMLButtonElement;
    const btnText = document.getElementById('btn-text') as HTMLSpanElement;
    const checkoutError = document.getElementById('checkout-error') as HTMLParagraphElement;
    
    const emailInput = document.getElementById('email') as HTMLInputElement;
    const nameInput = document.getElementById('name') as HTMLInputElement;
    const countrySelect = document.getElementById('country') as HTMLSelectElement;
    const termsCheckbox = document.getElementById('terms') as HTMLInputElement;
    
    const emailError = document.getElementById('email-error') as HTMLParagraphElement;
    const nameError = document.getElementById('name-error') as HTMLParagraphElement;
    const termsError = document.getElementById('terms-error') as HTMLParagraphElement;

    // Validaci√≥n de email
    function isValidEmail(email: string): boolean {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    // Limpiar errores al escribir
    emailInput?.addEventListener('input', () => {
        emailError.classList.add('hidden');
        emailInput.classList.remove('border-red-500');
    });

    nameInput?.addEventListener('input', () => {
        nameError.classList.add('hidden');
        nameInput.classList.remove('border-red-500');
    });

    termsCheckbox?.addEventListener('change', () => {
        termsError.classList.add('hidden');
    });

    form?.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Resetear errores
        emailError.classList.add('hidden');
        nameError.classList.add('hidden');
        termsError.classList.add('hidden');
        emailInput.classList.remove('border-red-500');
        nameInput.classList.remove('border-red-500');
        checkoutError.classList.add('hidden');
        checkoutError.textContent = '';

        let hasErrors = false;

        // Validar email
        if (!emailInput.value || !isValidEmail(emailInput.value)) {
            emailError.classList.remove('hidden');
            emailInput.classList.add('border-red-500');
            hasErrors = true;
        }

        // Validar nombre
        if (!nameInput.value || nameInput.value.trim().length < 2) {
            nameError.classList.remove('hidden');
            nameInput.classList.add('border-red-500');
            hasErrors = true;
        }

        // Validar t√©rminos
        if (!termsCheckbox.checked) {
            termsError.classList.remove('hidden');
            hasErrors = true;
        }

        if (hasErrors) {
            // Scroll al primer error
            const firstError = document.querySelector('.border-red-500') as HTMLElement;
            firstError?.scrollIntoView({ behavior: 'smooth', block: 'center' });
            return;
        }

        const originalText = btnText.innerText;
        btnText.innerText = "Procesando...";
        checkoutBtn.disabled = true;

        try {
            const response = await fetch('/api/checkout/create-session', { 
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    email: emailInput.value,
                    name: nameInput.value,
                    country: countrySelect.value
                })
            });

            if (!response.ok) throw new Error('Error al iniciar checkout');

            const { url } = await response.json();
            if (url) {
                window.location.href = url;
            } else {
                throw new Error('No se recibi√≥ URL de redirecci√≥n');
            }

        } catch (error) {
            console.error(error);
            checkoutError.textContent = 'Hubo un error al procesar el pago. Por favor intenta de nuevo.';
            checkoutError.classList.remove('hidden');
            btnText.innerText = originalText;
            checkoutBtn.disabled = false;
        }
    });
</script>
